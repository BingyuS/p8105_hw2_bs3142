---
title: "p8105_hw2_bs3142"
author: "Bingyu Sun"
date: "9/30/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

## Problem 1

Section 1

```{r cleaned_my_nyc_transit_data}
my_nyc_transit_data = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) %>%
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```


Section 2

Write a short paragraph about this dataset â€“ explain briefly what variables the dataset contains, describe your data cleaning steps so far, and give the dimension (rows x columns) of the resulting dataset. Are these data tidy?

The dataset consists of line, station name, station latitude and longitude, routes, entry, vending, entrance type, and ada. There are `r nrow(my_nyc_transit_data)` rows by `r ncol(my_nyc_transit_data)` columns.

Section 3

```{r}
distinct_my_nyc_transit_data = 
  my_nyc_transit_data %>%
  distinct(line, station_name, .keep_all = TRUE)

nrow(distinct_my_nyc_transit_data)
```

```{r}
distinct_my_nyc_transit_data %>%
  filter(ada == "TRUE") %>%
  count
```

```{r}
nrow(filter(my_nyc_transit_data, vending == "NO", entry == "TRUE")) / nrow(filter(my_nyc_transit_data, vending == "NO"))
```

There are 465 distinct train stations, and 84 of them are ada compliant. 0.0377


Section 4

```{r reformat my nyc transit data}
tidy_my_nyc_transit_data =
  my_nyc_transit_data %>%
  gather(key = "route_number", value = "route_name", route1:route11) %>%
  distinct(line, station_name, .keep_all = TRUE) %>%
  filter(route_name == "A") %>%
  filter(ada == "TRUE")
```

There are 60 distinct stations serve Train A, and 17 of them are ADA compliant.

## Problem 2

Question 1
```{r}
my_wheel_data =
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 1, range = ("A2:N258")) %>%
  janitor::clean_names() %>%
  filter(!is.na(dumpster)) %>%
  mutate(sports_balls = as.integer(sports_balls))
```

Question 2
```{r}
my_precip_2017_data = 
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 3, skip = 1) %>%
  janitor::clean_names() %>%
  rename(precipitation_in = total) %>%
  mutate(year = "2017") %>%
  filter(!is.na(month), !is.na(precipitation_in))
```

```{r}
my_precip_2016_data =
  readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 4, skip = 1) %>%
  janitor::clean_names() %>%
  rename(precipitation_in = total) %>%
  mutate(year = "2016") %>%
  filter(!is.na(month), !is.na(precipitation_in))
```

```{r}
my_combined_precip_data =
  bind_rows(my_precip_2016_data, my_precip_2017_data) %>%
  mutate(month = month.name[month])
```

## Problem 3

```{r}
library(p8105.datasets)
data(brfss_smart2010)
```

```{r}
my_brfss_data = 
  brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>%
  select(-(class:question), -sample_size, -(confidence_limit_low:geo_location)) %>%
  spread(key = response, value = data_value) %>%
  janitor::clean_names() %>%
  mutate(prop_excellent_and_very_good = (excellent + very_good))
```

```{r}
skimr::skim(my_brfss_data)
```

```{r}
hist_excellent_2002 = 
  select(my_brfss_data, year, excellent) %>%
  filter(year == "2002") %>%
  ggplot(aes(x = excellent)) +
  geom_histogram()
```

Scatterplot
```{r}
sp_excellent_nyc_qc_2002_2010 =
  select(my_brfss_data, year, locationdesc, excellent) %>%
  filter(locationdesc %in% c("NY - New York County", "NY - Queens County")) %>%
  ggplot(aes(x = year, y = excellent)) +
  geom_point()
```

